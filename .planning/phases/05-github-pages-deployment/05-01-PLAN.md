---
phase: 05-github-pages-deployment
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - vite.config.ts
  - package.json
  - .github/workflows/deploy.yml
autonomous: false

must_haves:
  truths:
    - "App loads at goom1000.github.io/PiPi with no 404 errors"
    - "Push to main triggers automatic deployment"
    - "All features work identically on deployed version"
  artifacts:
    - path: "vite.config.ts"
      provides: "GitHub Pages base path configuration"
      contains: "base: '/PiPi/'"
    - path: "package.json"
      provides: "Type check script for CI"
      contains: "typecheck"
    - path: ".github/workflows/deploy.yml"
      provides: "GitHub Actions deployment workflow"
      contains: "actions/deploy-pages"
  key_links:
    - from: ".github/workflows/deploy.yml"
      to: "npm run build"
      via: "CI build step"
      pattern: "npm run build"
    - from: "vite.config.ts"
      to: "dist/assets/*"
      via: "base path prefix"
      pattern: "/PiPi/"
---

<objective>
Configure and deploy PiPi to GitHub Pages so colleagues can access the app via goom1000.github.io/PiPi.

Purpose: Make the app accessible to colleagues without requiring local development setup
Output: Working GitHub Pages deployment with automatic CI/CD
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-github-pages-deployment/05-RESEARCH.md

@vite.config.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Vite for GitHub Pages</name>
  <files>vite.config.ts, package.json</files>
  <action>
    1. Update vite.config.ts:
       - Add `base: '/PiPi/'` to the returned config object
       - This ensures all asset paths are prefixed correctly for subdirectory deployment

    2. Update package.json scripts:
       - Add `"typecheck": "tsc --noEmit"` script
       - This enables type checking in CI before build

    The base path must be exactly `/PiPi/` (case-sensitive, with trailing slash) to match the repository name.
  </action>
  <verify>
    Run: `npm run build && npm run preview`
    Visit http://localhost:4173/PiPi/ - app should load correctly
    Check browser console - no 404 errors for assets
  </verify>
  <done>
    - vite.config.ts contains `base: '/PiPi/'`
    - package.json has `typecheck` script
    - Local preview at /PiPi/ path works
  </done>
</task>

<task type="auto">
  <name>Task 2: Create GitHub Actions workflow</name>
  <files>.github/workflows/deploy.yml</files>
  <action>
    Create `.github/workflows/deploy.yml` with the official Vite-recommended workflow:

    ```yaml
    name: Deploy to GitHub Pages

    on:
      push:
        branches: ['main']
      workflow_dispatch:

    permissions:
      contents: read
      pages: write
      id-token: write

    concurrency:
      group: 'pages'
      cancel-in-progress: true

    jobs:
      deploy:
        environment:
          name: github-pages
          url: ${{ steps.deployment.outputs.page_url }}
        runs-on: ubuntu-latest
        steps:
          - name: Checkout
            uses: actions/checkout@v5
          - name: Set up Node
            uses: actions/setup-node@v6
            with:
              node-version: 22
              cache: 'npm'
          - name: Install dependencies
            run: npm ci
          - name: Type check
            run: npm run typecheck
          - name: Build
            run: npm run build
          - name: Setup Pages
            uses: actions/configure-pages@v5
          - name: Upload artifact
            uses: actions/upload-pages-artifact@v4
            with:
              path: './dist'
          - name: Deploy to GitHub Pages
            id: deployment
            uses: actions/deploy-pages@v4
    ```

    This workflow:
    - Triggers on push to main and manual dispatch
    - Uses official GitHub Actions (not community actions)
    - Includes type check before build to catch errors
    - Uses npm caching for faster builds
  </action>
  <verify>
    Run: `cat .github/workflows/deploy.yml`
    Confirm file exists with correct content
  </verify>
  <done>
    - Workflow file exists at .github/workflows/deploy.yml
    - Contains all required permissions
    - Contains type check, build, and deploy steps
  </done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 3: Enable GitHub Pages in repository settings</name>
  <action>
    The user must configure GitHub Pages in the repository settings before deployment will work.
  </action>
  <instructions>
    **Repository:** https://github.com/Goom1000/PiPi

    **Step 1: Make repository public (if not already)**
    1. Go to Settings > General > Danger Zone
    2. Click "Change repository visibility"
    3. Select "Make public"
    4. Confirm by typing the repository name

    **Step 2: Enable GitHub Pages**
    1. Go to Settings > Pages (left sidebar)
    2. Under "Build and deployment" > Source
    3. Select "GitHub Actions" (NOT "Deploy from a branch")
    4. Click Save if needed

    **IMPORTANT:** The workflow will fail if you select "Deploy from a branch" instead of "GitHub Actions".
  </instructions>
  <resume-signal>Type "pages enabled" after completing both steps</resume-signal>
</task>

<task type="auto">
  <name>Task 4: Commit and push to trigger deployment</name>
  <files>None (git operations)</files>
  <action>
    1. Stage all changes:
       - vite.config.ts
       - package.json
       - .github/workflows/deploy.yml

    2. Commit with message:
       ```
       feat(deploy): add GitHub Pages deployment

       - Configure Vite base path for /PiPi/ subdirectory
       - Add typecheck script for CI validation
       - Add GitHub Actions workflow for auto-deploy on push

       Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
       ```

    3. Push to main branch

    Note: This will trigger the GitHub Actions workflow automatically.
  </action>
  <verify>
    Run: `git status` - should show clean working tree
    Check: https://github.com/Goom1000/PiPi/actions - workflow should be running
  </verify>
  <done>
    - All changes committed and pushed
    - GitHub Actions workflow triggered
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 5: Verify deployment works</name>
  <what-built>
    Complete GitHub Pages deployment with automatic CI/CD pipeline.
    The app should now be accessible at the public URL.
  </what-built>
  <how-to-verify>
    1. Check GitHub Actions status:
       - Visit https://github.com/Goom1000/PiPi/actions
       - Wait for the "Deploy to GitHub Pages" workflow to complete (green checkmark)
       - If red X, check the logs for error details

    2. Visit the deployed app:
       - URL: https://goom1000.github.io/PiPi/
       - App should load (not blank page)
       - No 404 errors in browser console

    3. Test key features:
       - Create a new slide
       - Open settings (gear icon)
       - Save a presentation
       - Load a presentation
       - All features should work identically to local dev

    **Troubleshooting:**
    - Blank page? Check browser console for 404 errors on assets
    - Workflow not running? Verify Pages is set to "GitHub Actions" source
    - Build failed? Check TypeScript errors in workflow logs
  </how-to-verify>
  <resume-signal>Type "deployment verified" if app works, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
**Phase verification:**
- [ ] App loads at https://goom1000.github.io/PiPi/
- [ ] No 404 errors in browser console
- [ ] GitHub Actions workflow completes successfully
- [ ] Push to main triggers automatic deployment
- [ ] All app features work on deployed version
</verification>

<success_criteria>
- DEPL-01: App accessible at goom1000.github.io/PiPi (no blank page)
- DEPL-02: Push to main triggers GitHub Actions deployment
- DEPL-03: All features work identically (settings, save/load, AI features)
</success_criteria>

<output>
After completion, create `.planning/phases/05-github-pages-deployment/05-01-SUMMARY.md`
</output>
