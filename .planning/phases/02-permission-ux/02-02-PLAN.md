---
phase: 02-permission-ux
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - components/PresentationView.tsx
autonomous: true

must_haves:
  truths:
    - "Teacher can click 'Enable auto-placement' link to trigger permission request"
    - "Link is visible when permission state is 'prompt' and multiple screens detected"
    - "Link is NOT visible when permission is granted or denied"
    - "PermissionExplainer popup is no longer used"
  artifacts:
    - path: "components/PresentationView.tsx"
      provides: "Inline permission request link"
      contains: "Enable auto-placement"
  key_links:
    - from: "components/PresentationView.tsx"
      to: "requestPermission function"
      via: "onClick handler on inline link"
      pattern: "requestPermission"
---

<objective>
Replace the PermissionExplainer popup with an inline text link for permission requests.

Purpose: Simpler UX - teacher sees subtle "Enable auto-placement" link near button, clicks it, browser prompts. No pre-prompt explanation needed per CONTEXT.md.

Output: Modified PresentationView.tsx with inline permission link, removal of PermissionExplainer popup usage.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-permission-ux/02-CONTEXT.md
@.planning/phases/02-permission-ux/02-RESEARCH.md
@.planning/phases/02-permission-ux/02-01-SUMMARY.md

@components/PresentationView.tsx
@components/PermissionExplainer.tsx
@hooks/useWindowManagement.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add inline permission request link</name>
  <files>components/PresentationView.tsx</files>
  <action>
Add an inline text link near the launch button for permission requests:

1. Locate the launch button area (around lines 441-536).

2. Add the permission link AFTER the launch button, rendered conditionally:
   ```tsx
   {/* Permission request link - only when prompt state and multi-screen */}
   {!isLoading && permissionState === 'prompt' && hasMultipleScreens && !isConnected && (
     <button
       onClick={requestPermission}
       className="text-xs text-blue-400 hover:text-blue-300 underline transition-colors ml-2"
     >
       Enable auto-placement
     </button>
   )}
   ```

3. Position this after the launch button, on the same line or directly below, depending on header layout. The link should be subtle (text link style, not a button).

4. The link text is exactly "Enable auto-placement" per CONTEXT.md.

5. Clicking the link directly calls `requestPermission()` from the hook - no intermediate state needed.
  </action>
  <verify>
Read the button area code. Verify:
- Link appears when permissionState === 'prompt' AND hasMultipleScreens AND !isConnected AND !isLoading
- Link text is "Enable auto-placement"
- Link calls requestPermission() on click
- Link is styled as subtle text link (underline, small text, blue color)
  </verify>
  <done>Inline permission link renders in appropriate conditions</done>
</task>

<task type="auto">
  <name>Task 2: Remove PermissionExplainer popup usage</name>
  <files>components/PresentationView.tsx</files>
  <action>
Remove the PermissionExplainer component and its associated state:

1. Remove the import: `import PermissionExplainer from './PermissionExplainer';` (around line 10)

2. Remove the state: `const [showPermissionExplainer, setShowPermissionExplainer] = useState(false);` (around line 233)

3. Remove the useEffect that sets showPermissionExplainer (around lines 245-249):
   ```tsx
   // DELETE THIS BLOCK
   useEffect(() => {
     if (!isLoading && isSupported && hasMultipleScreens && permissionState === 'prompt') {
       setShowPermissionExplainer(true);
     }
   }, [isLoading, isSupported, hasMultipleScreens, permissionState]);
   ```

4. Remove the PermissionExplainer JSX render (around lines 483-492):
   ```tsx
   // DELETE THIS BLOCK
   {showPermissionExplainer && (
     <PermissionExplainer
       onRequestPermission={async () => {
         await requestPermission();
         setShowPermissionExplainer(false);
       }}
       onSkip={() => setShowPermissionExplainer(false)}
     />
   )}
   ```

5. Do NOT delete the PermissionExplainer.tsx file - just remove its usage. It can be deleted in a cleanup pass later.

6. Verify `isSupported` is still imported from the hook even if not used elsewhere - it's needed for ManualPlacementGuide condition.
  </action>
  <verify>
Run: `npx tsc --noEmit`
Grep for PermissionExplainer in PresentationView: should not be found except possibly as a comment.
Verify showPermissionExplainer state is removed.
  </verify>
  <done>PermissionExplainer popup no longer rendered or referenced</done>
</task>

</tasks>

<verification>
- [ ] TypeScript compiles: `npx tsc --noEmit`
- [ ] "Enable auto-placement" link appears when permissionState === 'prompt' (inspect code)
- [ ] Link disappears after permission granted (inspect code - condition includes permissionState === 'prompt')
- [ ] PermissionExplainer no longer imported or rendered
- [ ] No unused state variables (showPermissionExplainer removed)
- [ ] ManualPlacementGuide still works (still uses isSupported from hook)
</verification>

<success_criteria>
1. PERM-03 satisfied: User can trigger permission request from visible, non-dismissible UI element
2. Simpler UX: No pre-prompt explanation popup, just click link -> browser prompts
3. Link visibility correctly gated on permission state
</success_criteria>

<output>
After completion, create `.planning/phases/02-permission-ux/02-02-SUMMARY.md`
</output>
