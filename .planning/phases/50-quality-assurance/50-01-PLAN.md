---
phase: 50-quality-assurance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - services/contentPreservation/qualityTestFixtures/elementary-math-sparse.md
  - services/contentPreservation/qualityTestFixtures/elementary-science-dense.md
  - services/contentPreservation/qualityTestFixtures/edge-case-multi-mode.md
  - services/contentPreservation/qualityTestFixtures/REVIEW-CHECKLIST.md
autonomous: true

must_haves:
  truths:
    - "Test fixtures cover sparse (1-2) and dense (5+) preservation scenarios"
    - "Test fixtures target elementary (K-5) vocabulary level"
    - "Quality review checklist enables consistent evaluation"
  artifacts:
    - path: "services/contentPreservation/qualityTestFixtures/elementary-math-sparse.md"
      provides: "Sparse preservation test case (1-2 items)"
      contains: "Ask"
    - path: "services/contentPreservation/qualityTestFixtures/elementary-science-dense.md"
      provides: "Dense preservation test case (5+ items)"
      min_lines: 20
    - path: "services/contentPreservation/qualityTestFixtures/edge-case-multi-mode.md"
      provides: "Edge case with long question and multi-part activity"
    - path: "services/contentPreservation/qualityTestFixtures/REVIEW-CHECKLIST.md"
      provides: "Structured quality review criteria"
      contains: "vocabulary"
  key_links:
    - from: "services/contentPreservation/qualityTestFixtures/*.md"
      to: "services/contentPreservation/detector.ts"
      via: "fixtures designed to trigger detection patterns"
      pattern: "Ask|List|Discuss"
---

<objective>
Create test fixtures and quality review infrastructure for Phase 50 quality assurance.

Purpose: Enable systematic validation that content preservation (Phases 48-49) works correctly without degrading non-preserved content quality.
Output: 3 test lesson plans (sparse, dense, edge-case) plus a structured quality review checklist.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/50-quality-assurance/50-CONTEXT.md
@.planning/phases/50-quality-assurance/50-RESEARCH.md
@services/contentPreservation/detector.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sparse and dense test fixtures</name>
  <files>
    services/contentPreservation/qualityTestFixtures/elementary-math-sparse.md
    services/contentPreservation/qualityTestFixtures/elementary-science-dense.md
  </files>
  <action>
Create the qualityTestFixtures directory and two lesson plan fixtures:

1. **elementary-math-sparse.md** (Grade 3 Fractions, 1-2 preserved elements):
   - Hook section introducing fractions
   - I Do section with ONE explicit question using "Ask students:" prefix
   - We Do section with ONE activity using action verb (e.g., "Draw...")
   - You Do section referencing worksheet practice
   - Total: 2 preserved elements (1 question, 1 activity)
   - Keep vocabulary at Year 3 level (simple words, short sentences)

2. **elementary-science-dense.md** (Grade 4 Water Cycle, 5+ preserved elements):
   - Introduction with 2 explicit questions
   - Multiple sections (Evaporation, Condensation, Precipitation) each with a question
   - Activity section with 3 activities using varied action verbs (List, Discuss, Compare)
   - Total: 7+ preserved elements
   - Use "Ask:", "Ask students:", "Question:" prefixes and action verbs from Bloom's taxonomy

Use the example fixtures from 50-RESEARCH.md as templates. Ensure each fixture uses grade-appropriate vocabulary (elementary = simple words) and follows pedagogical structure (Hook, I Do, We Do, You Do where applicable).
  </action>
  <verify>
Run detection on fixtures to confirm expected element counts:
```bash
# Verify sparse fixture has ~2 detections
npx tsx -e "import {detectPreservableContent} from './services/contentPreservation/detector'; import fs from 'fs'; const t=fs.readFileSync('./services/contentPreservation/qualityTestFixtures/elementary-math-sparse.md','utf8'); const r=detectPreservableContent(t); console.log('Sparse: Q='+r.questions.length+', A='+r.activities.length);"

# Verify dense fixture has 5+ detections
npx tsx -e "import {detectPreservableContent} from './services/contentPreservation/detector'; import fs from 'fs'; const t=fs.readFileSync('./services/contentPreservation/qualityTestFixtures/elementary-science-dense.md','utf8'); const r=detectPreservableContent(t); console.log('Dense: Q='+r.questions.length+', A='+r.activities.length);"
```
  </verify>
  <done>
Sparse fixture detects 1-2 questions, 1-2 activities.
Dense fixture detects 5+ total elements (questions + activities).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create edge case fixture and quality review checklist</name>
  <files>
    services/contentPreservation/qualityTestFixtures/edge-case-multi-mode.md
    services/contentPreservation/qualityTestFixtures/REVIEW-CHECKLIST.md
  </files>
  <action>
Create two more files:

1. **edge-case-multi-mode.md** (Grade 5 Reading Comprehension):
   - Include ONE very long question (30+ words) to test handling
   - Include ONE multi-part activity instruction ("First... then... finally...")
   - Include ONE rhetorical question (should be flagged low confidence)
   - This fixture tests edge cases: long content, complex instructions, ambiguous detection
   - Suitable for all three modes (Fresh, Refine, Blend) testing

2. **REVIEW-CHECKLIST.md** - Quality review template with sections:

   ```markdown
   # Quality Review: [Test Case Name]

   **Date:** [YYYY-MM-DD]
   **Provider:** Claude / Gemini
   **Mode:** Fresh / Refine / Blend
   **Grade Level:** [e.g., Year 3]
   **Preserved Elements Detected:** [count]

   ## 1. Preservation Verification

   | Detected Content | Found in Output? | Location | Verbatim? |
   |------------------|------------------|----------|-----------|
   | [question 1] | Yes/No | Slide X | Yes/Adapted |

   ## 2. Non-Preserved Content Quality (QUAL-01)

   - [ ] Vocabulary matches elementary grade level (simple words)
   - [ ] Student-friendly tone (direct but approachable)
   - [ ] Complete sentences, not fragments
   - [ ] No teacher meta-language ("students will learn...")

   **Notes:**

   ## 3. Slide Flow (QUAL-02)

   - [ ] Natural transitions between slides
   - [ ] Preserved content feels integrated, not jarring
   - [ ] Hook -> I Do -> We Do -> You Do structure maintained (if applicable)

   **Notes:**

   ## 4. Teleprompter Quality (QUAL-03)

   - [ ] Conversational coaching style
   - [ ] Preserved questions introduced naturally ("Now ask the class:")
   - [ ] Timing cues present where appropriate
   - [ ] Not robotic reading of slide content

   **Notes:**

   ## 5. Layout Compatibility (QUAL-04)

   - [ ] Content renders correctly (spot check only per CONTEXT.md)
   - [ ] No obvious overflow issues

   **Notes:**

   ## Overall Assessment

   - [ ] PASS - Quality matches pre-preservation baseline
   - [ ] NEEDS REFINEMENT - Specific issues below

   ## Issues Found (if any)

   | Issue | Severity | Suggested Fix |
   |-------|----------|---------------|
   | | | |

   ## Prompt Refinement Notes

   [If refinement needed, describe what to change in contentPreservationRules.ts or provider prompts]
   ```

The checklist maps directly to the four QUAL requirements and provides structured documentation for the manual review.
  </action>
  <verify>
Files exist and have expected structure:
```bash
ls -la services/contentPreservation/qualityTestFixtures/
head -50 services/contentPreservation/qualityTestFixtures/REVIEW-CHECKLIST.md
```
  </verify>
  <done>
4 fixture files exist in qualityTestFixtures directory.
REVIEW-CHECKLIST.md contains sections for all 4 QUAL requirements.
Edge case fixture includes long question (30+ words), multi-part activity, and rhetorical question.
  </done>
</task>

</tasks>

<verification>
All Phase 50 test infrastructure ready:
1. 3 test lesson plan fixtures created (sparse, dense, edge case)
2. Quality review checklist covers QUAL-01 through QUAL-04
3. Detection runs successfully on fixtures
4. Files are markdown format, no dependencies added
</verification>

<success_criteria>
1. Sparse fixture (elementary-math-sparse.md) detects 1-2 preserved elements
2. Dense fixture (elementary-science-dense.md) detects 5+ preserved elements
3. Edge case fixture includes long question, multi-part activity, rhetorical question
4. REVIEW-CHECKLIST.md has sections mapping to QUAL-01, QUAL-02, QUAL-03, QUAL-04
5. All fixtures use elementary (K-5) vocabulary level
</success_criteria>

<output>
After completion, create `.planning/phases/50-quality-assurance/50-01-SUMMARY.md`
</output>
