---
phase: 26-student-view-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - index.html
  - components/games/shared/Timer.tsx
  - components/games/shared/ScoreDisplay.tsx
autonomous: true

must_haves:
  truths:
    - "Timers are large and readable from classroom back (text-7xl/8xl)"
    - "Urgency styling includes screen edge glow at <=10 seconds"
    - "Score updates show brief scale animation when changing"
  artifacts:
    - path: "index.html"
      provides: "CSS keyframes for urgency-glow and rapid-pulse animations"
      contains: "@keyframes urgentScreenGlow"
    - path: "components/games/shared/Timer.tsx"
      provides: "Enhanced timer with larger text and screen glow trigger"
      contains: "text-7xl"
    - path: "components/games/shared/ScoreDisplay.tsx"
      provides: "Score display with animation on value changes"
      contains: "scale-125"
  key_links:
    - from: "index.html"
      to: "components/*"
      via: "CSS class names"
      pattern: "animate-urgency-glow|animate-rapid-pulse"
---

<objective>
Add CSS animations and enhance shared game components for classroom visibility.

Purpose: Foundation for all student view enhancements - animations and larger displays for classroom readability
Output: Enhanced Timer and ScoreDisplay components with urgency effects
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-student-view-integration/26-CONTEXT.md
@.planning/phases/26-student-view-integration/26-RESEARCH.md

@index.html
@components/games/shared/Timer.tsx
@components/games/shared/ScoreDisplay.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add urgency CSS animations to index.html</name>
  <files>index.html</files>
  <action>
Add the following CSS keyframes to the existing style block in index.html:

1. **urgentScreenGlow** - Screen edge glow for timer urgency
   - Animate inset box-shadow from subtle red (0.3 opacity) to dramatic (0.6 opacity)
   - 0.5s duration, ease-in-out, infinite
   - Class: `.animate-urgency-glow`

2. **rapidPulse** - Fast pulsing for urgent timer text
   - Scale from 1 to 1.08 and back
   - 0.3s duration, ease-in-out, infinite
   - Class: `.animate-rapid-pulse`

Add these after the existing chase animations in the style block.

```css
/* Student view urgency animations */
@keyframes urgentScreenGlow {
  0%, 100% {
    box-shadow: inset 0 0 60px rgba(239, 68, 68, 0.3);
  }
  50% {
    box-shadow: inset 0 0 120px rgba(239, 68, 68, 0.6);
  }
}

.animate-urgency-glow {
  animation: urgentScreenGlow 0.5s ease-in-out infinite;
}

@keyframes rapidPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.08); }
}

.animate-rapid-pulse {
  animation: rapidPulse 0.3s ease-in-out infinite;
}
```
  </action>
  <verify>Search index.html for "urgentScreenGlow" - should find the keyframe definition</verify>
  <done>CSS keyframes for urgency-glow and rapid-pulse animations exist in index.html</done>
</task>

<task type="auto">
  <name>Task 2: Enhance Timer component for classroom visibility</name>
  <files>components/games/shared/Timer.tsx</files>
  <action>
Enhance the Timer component to support larger sizes and optional screen glow:

1. Add new size variant 'classroom' that uses text-7xl md:text-8xl
2. Add optional prop `showScreenGlow?: boolean` (default false)
3. When showScreenGlow is true AND timer is urgent (<=threshold AND >0):
   - Render a fixed inset div with animate-urgency-glow class
   - This div should be pointer-events-none, z-30, positioned via className="fixed inset-0"
4. For urgent state with classroom size, use animate-rapid-pulse instead of animate-pulse

Update the size classes:
- 'small': text-2xl (unchanged)
- 'large': text-6xl (unchanged)
- 'classroom': text-7xl md:text-8xl font-black

The component should remain backward compatible - existing usages with size="large" continue to work.

Note: The screen glow overlay renders OUTSIDE the timer div, conditionally based on showScreenGlow prop.
  </action>
  <verify>Read Timer.tsx and confirm 'classroom' size variant exists with text-7xl md:text-8xl</verify>
  <done>Timer has classroom size variant with text-7xl/8xl and optional screen glow support</done>
</task>

<task type="auto">
  <name>Task 3: Add score animation to ScoreDisplay</name>
  <files>components/games/shared/ScoreDisplay.tsx</files>
  <action>
Enhance ScoreDisplay to animate score changes:

1. Add local state to track previous score values for animation detection
2. Use useRef to track previous score for each team (team mode) or single player (individual mode)
3. When score changes, apply a brief scale-125 + text-amber-400 transition for 200ms

For team mode:
- Track previous scores using a ref: `prevScoresRef = useRef<Record<string, number>>({})`
- Compare current team.score vs prevScoresRef.current[team.id]
- If different, apply animating class for 200ms via setTimeout

For individual mode: No score to animate (just player name badge), skip animation logic.

Implementation pattern:
```typescript
const [animatingTeams, setAnimatingTeams] = useState<Set<string>>(new Set());
const prevScoresRef = useRef<Record<string, number>>({});

useEffect(() => {
  if (competitionMode.mode !== 'team') return;

  const newAnimating = new Set<string>();
  competitionMode.teams.forEach(team => {
    if (prevScoresRef.current[team.id] !== undefined &&
        prevScoresRef.current[team.id] !== team.score) {
      newAnimating.add(team.id);
    }
    prevScoresRef.current[team.id] = team.score;
  });

  if (newAnimating.size > 0) {
    setAnimatingTeams(newAnimating);
    setTimeout(() => setAnimatingTeams(new Set()), 200);
  }
}, [competitionMode]);
```

Apply animation classes to the score number div:
```
${animatingTeams.has(team.id) ? 'scale-125 text-amber-400' : 'scale-100'}
```

Add transition-all duration-200 to ensure smooth animation.
  </action>
  <verify>Read ScoreDisplay.tsx and confirm animatingTeams state and useEffect for score change detection exist</verify>
  <done>ScoreDisplay animates team scores with scale+color pulse when values change</done>
</task>

</tasks>

<verification>
1. Check index.html contains urgentScreenGlow and rapidPulse keyframes
2. Check Timer.tsx has 'classroom' size option with text-7xl/8xl
3. Check ScoreDisplay.tsx has animation logic for score changes
4. Run `npm run build` to verify no TypeScript errors
</verification>

<success_criteria>
- CSS keyframes urgentScreenGlow and rapidPulse defined in index.html
- Timer component supports 'classroom' size (text-7xl md:text-8xl) and showScreenGlow prop
- ScoreDisplay animates score changes with 200ms scale+color transition
- All existing functionality preserved (backward compatible)
</success_criteria>

<output>
After completion, create `.planning/phases/26-student-view-integration/26-01-SUMMARY.md`
</output>
