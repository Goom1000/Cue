---
phase: 21-millionaire-game
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - types.ts
  - components/games/millionaire/MoneyTree.tsx
  - components/games/millionaire/millionaireConfig.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "MillionaireState type supports all required game fields"
    - "Money tree configuration scales correctly for 3, 5, and 10 question counts"
    - "Money Tree component displays prize ladder with current position highlighted"
    - "Safe havens are visually distinct in the money tree"
  artifacts:
    - path: "types.ts"
      provides: "Extended MillionaireState with eliminatedOptions, audiencePoll, phoneHint, safeHavenAmount, questionCount"
      contains: "eliminatedOptions"
    - path: "components/games/millionaire/millionaireConfig.ts"
      provides: "MONEY_TREE_CONFIGS for 3, 5, 10 question variants"
      exports: ["MONEY_TREE_CONFIGS", "getSafeHavenAmount", "MoneyTreeConfig"]
    - path: "components/games/millionaire/MoneyTree.tsx"
      provides: "Visual prize ladder component"
      exports: ["MoneyTree"]
  key_links:
    - from: "components/games/millionaire/MoneyTree.tsx"
      to: "millionaireConfig.ts"
      via: "import MoneyTreeConfig"
      pattern: "import.*MoneyTreeConfig"
---

<objective>
Create the Millionaire game foundation: extended type system and Money Tree component

Purpose: Establish the data structures and core UI component needed for the Millionaire game before adding game logic.

Output: Extended MillionaireState type, money tree configuration system, and MoneyTree component ready for integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-millionaire-game/21-CONTEXT.md
@.planning/phases/21-millionaire-game/21-RESEARCH.md

# Key source files
@types.ts
@components/games/MillionaireGame.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend MillionaireState type and create money tree configuration</name>
  <files>types.ts, components/games/millionaire/millionaireConfig.ts</files>
  <action>
  1. In types.ts, extend MillionaireState to add these fields:
     - eliminatedOptions: number[] (indices hidden by 50:50)
     - audiencePoll: [number, number, number, number] | null (A, B, C, D percentages)
     - phoneHint: { confidence: 'high' | 'medium' | 'low'; response: string } | null
     - safeHavenAmount: number (current guaranteed minimum)
     - questionCount: 3 | 5 | 10 (selected at game launch)

  2. Create components/games/millionaire/millionaireConfig.ts with:
     ```typescript
     export interface MoneyTreeConfig {
       questionCount: 3 | 5 | 10;
       prizes: number[];
       safeHavens: number[]; // Question indices (0-based)
     }

     export const MONEY_TREE_CONFIGS: Record<3 | 5 | 10, MoneyTreeConfig> = {
       3: {
         questionCount: 3,
         prizes: [500, 2000, 10000],
         safeHavens: [2], // Question 3 is safe haven
       },
       5: {
         questionCount: 5,
         prizes: [200, 500, 1000, 5000, 25000],
         safeHavens: [2, 4], // Questions 3 and 5 are safe havens
       },
       10: {
         questionCount: 10,
         prizes: [100, 200, 500, 1000, 2000, 5000, 10000, 25000, 50000, 100000],
         safeHavens: [4, 9], // Questions 5 and 10 are safe havens
       },
     };

     export const getSafeHavenAmount = (
       currentQuestionIndex: number,
       config: MoneyTreeConfig
     ): number => {
       const passedSafeHavens = config.safeHavens.filter(sh => sh < currentQuestionIndex);
       if (passedSafeHavens.length === 0) return 0;
       const lastSafeHaven = Math.max(...passedSafeHavens);
       return config.prizes[lastSafeHaven];
     };
     ```

  Note: Keep the existing MillionaireState fields (selectedOption, lifelines, prizeLadder, currentPrize) as they are compatible. Just ADD the new fields.
  </action>
  <verify>TypeScript compiles without errors: `npm run build` succeeds</verify>
  <done>MillionaireState has all extended fields, MONEY_TREE_CONFIGS provides correct prize ladders for all 3 question counts</done>
</task>

<task type="auto">
  <name>Task 2: Create MoneyTree component</name>
  <files>components/games/millionaire/MoneyTree.tsx</files>
  <action>
  Create components/games/millionaire/MoneyTree.tsx:

  ```typescript
  import React from 'react';
  import { MoneyTreeConfig } from './millionaireConfig';

  interface MoneyTreeProps {
    config: MoneyTreeConfig;
    currentQuestionIndex: number;
    answeredCorrectly: boolean[]; // Track which questions were answered
  }

  const MoneyTree: React.FC<MoneyTreeProps> = ({ config, currentQuestionIndex, answeredCorrectly }) => {
    return (
      <div className="flex flex-col-reverse gap-1 bg-blue-950/80 p-3 rounded-xl border border-blue-400/30">
        {config.prizes.map((prize, idx) => {
          const isCurrent = idx === currentQuestionIndex;
          const isAnswered = idx < currentQuestionIndex;
          const isSafeHaven = config.safeHavens.includes(idx);

          return (
            <div
              key={idx}
              className={`
                flex items-center justify-between px-3 py-1.5 rounded-lg text-sm font-bold
                transition-all duration-300
                ${isCurrent ? 'bg-amber-500 text-amber-950 scale-105 shadow-lg shadow-amber-500/50' : ''}
                ${isAnswered ? 'text-green-400' : 'text-white/70'}
                ${isSafeHaven && !isAnswered ? 'text-amber-400 border border-amber-500/50' : ''}
              `}
            >
              <span className="w-6 text-center">{idx + 1}</span>
              <span className={isSafeHaven ? 'font-black' : ''}>
                ${prize.toLocaleString()}
              </span>
              {isAnswered && (
                <svg className="w-4 h-4 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                </svg>
              )}
            </div>
          );
        })}
      </div>
    );
  };

  export default MoneyTree;
  ```

  Component requirements:
  - Flex column-reverse so highest prize appears at top (classic Millionaire layout)
  - Current question highlighted in amber with scale and shadow
  - Answered questions shown in green with checkmark
  - Safe havens have amber border and bold text when not yet reached
  - Use Tailwind classes consistent with existing game components (bg-blue-950, etc.)
  </action>
  <verify>Component renders without errors, visual inspection shows correct layout with prizes ascending</verify>
  <done>MoneyTree component displays prize ladder vertically with current position, answered questions, and safe havens visually distinct</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds without TypeScript errors
2. MillionaireState in types.ts has all new fields
3. millionaireConfig.ts exports MONEY_TREE_CONFIGS with 3, 5, 10 variants
4. getSafeHavenAmount correctly returns 0 before first safe haven, correct amount after
5. MoneyTree.tsx renders without errors
</verification>

<success_criteria>
- Extended MillionaireState type compiles
- MONEY_TREE_CONFIGS has correct prize amounts and safe haven positions for 3, 5, 10 question variants
- MoneyTree component renders vertical prize ladder with visual distinction for current, answered, and safe haven positions
</success_criteria>

<output>
After completion, create `.planning/phases/21-millionaire-game/21-01-SUMMARY.md`
</output>
