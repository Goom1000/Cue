---
phase: 11-class-management-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - hooks/useClassBank.ts
  - components/Toast.tsx
autonomous: true

must_haves:
  truths:
    - "useClassBank provides renameClass function that updates class name in localStorage"
    - "useClassBank provides updateClassStudents function that updates student array in localStorage"
    - "Toast can display an action button that triggers callback when clicked"
    - "Undo action in toast can restore deleted data"
  artifacts:
    - path: "hooks/useClassBank.ts"
      provides: "renameClass and updateClassStudents functions"
      exports: ["useClassBank"]
    - path: "components/Toast.tsx"
      provides: "Toast with optional action button"
      exports: ["useToast", "Toast", "ToastContainer", "ToastData"]
  key_links:
    - from: "components/Toast.tsx"
      to: "ToastData interface"
      via: "action property"
      pattern: "action\\?.*label.*onClick"
---

<objective>
Extend useClassBank hook with rename and update functions, and enhance Toast component to support action buttons for undo functionality.

Purpose: Provide the data layer (hook functions) and UI feedback mechanism (toast with undo) needed for class management operations.

Output: Extended useClassBank hook and Toast component ready for ClassManagementModal.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-class-management-ui/11-CONTEXT.md
@.planning/phases/11-class-management-ui/11-RESEARCH.md
@.planning/phases/10-class-bank-core/10-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend useClassBank with rename and update functions</name>
  <files>hooks/useClassBank.ts</files>
  <action>
Add two new functions to the useClassBank hook:

1. `renameClass(classId: string, newName: string)`:
   - Find class by ID
   - Trim newName; if empty, do nothing
   - Update the class name in state
   - Update savedAt timestamp to current ISO string
   - State update triggers existing useEffect to persist to localStorage

2. `updateClassStudents(classId: string, students: string[])`:
   - Find class by ID
   - Update the students array
   - Update savedAt timestamp to current ISO string
   - State update triggers existing useEffect to persist to localStorage

Both functions should use useCallback for stable references. Follow existing patterns from saveClass and deleteClass.

Return both new functions from the hook alongside existing returns:
```typescript
return {
  classes,
  saveClass,
  deleteClass,
  getClassByName,
  refreshClasses,
  renameClass,      // NEW
  updateClassStudents,  // NEW
};
```
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Hook exports all expected functions
  </verify>
  <done>
renameClass updates class name and savedAt timestamp in localStorage.
updateClassStudents updates student array and savedAt timestamp in localStorage.
Both functions are exported from useClassBank hook.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extend Toast with action button support</name>
  <files>components/Toast.tsx</files>
  <action>
Extend the Toast system to support an optional action button (for undo functionality).

1. Update ToastData interface:
```typescript
export interface ToastData {
  id: string;
  message: string;
  duration: number;
  variant?: ToastVariant;
  action?: {
    label: string;
    onClick: () => void;
  };
}
```

2. Update useToast hook's addToast function to accept optional action:
```typescript
const addToast = useCallback((
  message: string,
  duration: number = 3000,
  variant?: ToastVariant,
  action?: { label: string; onClick: () => void }
) => {
  const id = crypto.randomUUID();
  setToasts((prev) => [...prev, { id, message, duration, variant, action }]);
}, []);
```

3. Update ToastProps interface to include action:
```typescript
interface ToastProps {
  message: string;
  duration: number;
  onDismiss: () => void;
  variant?: ToastVariant;
  action?: {
    label: string;
    onClick: () => void;
  };
}
```

4. Update Toast component to render action button:
- Add action button before the message text or after
- Style: Small, underlined text or pill button that fits toast aesthetic
- On click: Call action.onClick() then dismiss the toast
- Suggested styling (adjust to match existing patterns):
```tsx
{action && (
  <button
    onClick={() => {
      action.onClick();
      onDismiss();
    }}
    className="ml-3 font-bold underline hover:no-underline"
  >
    {action.label}
  </button>
)}
```

5. Update ToastContainer to pass action prop to Toast component.

Keep backward compatibility - existing calls without action should work unchanged.
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Toast renders without action (backward compatible)
Toast renders with action button when provided
  </verify>
  <done>
Toast displays optional action button.
Clicking action button calls onClick callback and dismisses toast.
Existing toast calls without action continue to work.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. Vite builds successfully: `npm run build`
3. Manual verification:
   - Import useClassBank in a test file, destructure renameClass and updateClassStudents
   - Import addToast, call with action parameter
</verification>

<success_criteria>
1. useClassBank exports renameClass(classId, newName) function
2. useClassBank exports updateClassStudents(classId, students) function
3. Both functions update localStorage when called
4. Toast component can display action button with label and onClick
5. All existing functionality unchanged (backward compatible)
</success_criteria>

<output>
After completion, create `.planning/phases/11-class-management-ui/11-01-SUMMARY.md`
</output>
