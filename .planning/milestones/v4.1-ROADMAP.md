# Milestone v4.1: Script Mode (Share with Colleague)

**Status:** SHIPPED 2026-02-08
**Phases:** 61-64
**Total Plans:** 5

## Overview

Transform Cue's teleprompter-driven presentations into standalone teaching materials that any colleague can deliver without the app. AI text transformation converts progressive-disclosure teleprompter scripts into expanded, self-contained talking-point bullets. PPTX and PDF export deliver the primary and secondary formats. ShareModal UI provides the teacher-facing workflow with preview and progress.

## Phases

### Phase 61: AI Transformation Service
**Goal**: Teachers' teleprompter scripts are transformed by AI into expanded, self-contained talking-point bullets suitable for a colleague to read and deliver
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 61-01: Transformation prompt module, types, schemas, and helpers
- [x] 61-02: GeminiProvider and ClaudeProvider implementations

**Details:**
- Created `services/prompts/transformationPrompts.ts` with system prompt, user prompt builder, context builder, verbosity resolver, slide filter, chunking utility, and dual-provider schemas
- Added `TransformedSlide` interface and `ColleagueTransformationResult` type
- Sequential chunk processing with cross-chunk context summaries
- Temperature 0.7 for creative delivery text, maxOutputTokens 8192
- Bold key terms, flat bullets (no sub-bullets), chunking threshold of 20 slides

### Phase 62: PPTX Export
**Goal**: Teachers can download a PowerPoint file containing their slides with expanded talking-point bullets and images
**Depends on**: Phase 61
**Plans**: 1 plan

Plans:
- [x] 62-01: Script-mode PPTX export function with dedicated layout

**Details:**
- Added `exportScriptPptx` function to `services/pptxService.ts` (93 lines)
- White background, 18pt title, 16pt bullets with fit:shrink
- 2.5x1.9" image thumbnails with `originalPastedImage || imageUrl` priority
- Strips markdown bold markers for clean PPTX text

### Phase 63: Share Modal UI
**Goal**: Teachers have a complete share workflow — click a button, see transformation progress, preview the script version, and download
**Depends on**: Phase 61, Phase 62
**Plans**: 1 plan

Plans:
- [x] 63-01: onProgress callback, ShareModal component, and App.tsx wiring

**Details:**
- Created `components/ShareModal.tsx` (361 lines) with 4-phase state machine: transforming, preview, exporting, error
- Added `onProgress` callback to `transformForColleague` interface and both providers
- Wired Share button into editor toolbar in `App.tsx`
- Text-based preview cards (not SlideContentRenderer) since transformed data is bullets
- setTimeout wrapper around synchronous exportScriptPptx for UI state render

### Phase 64: PDF Export
**Goal**: Teachers can download a PDF version of the script-mode deck with readable text and images
**Depends on**: Phase 61, Phase 63
**Plans**: 1 plan

Plans:
- [x] 64-01: exportScriptPdf function and ShareModal PDF wiring

**Details:**
- Created `services/pdfService.ts` with `exportScriptPdf` function using jsPDF
- A4 portrait PDFs with compressed JPEG thumbnails
- Cue marker styling (italic indigo #4F46E5) with 5mm indent
- Page-break continuation headers
- Async export (Image onload + canvas) unlike sync PPTX export
- Bold markers stripped for clean PDF text

---

## Milestone Summary

**Key Decisions:**
- Zero new dependencies — PptxGenJS 3.12.0 (CDN), jsPDF, html2canvas, existing AI providers
- Transform-then-export pipeline — temporary ScriptSlide in memory, never mutate original deck
- Batched AI calls (5-8 slides per request) for cross-slide context and token safety
- Separate exportScriptPptx function (not parameterized exportToPowerPoint) — different layout concerns
- Self-contained PDF config in pdfService.ts (not imported from exportService.ts) to avoid coupling
- Short toolbar label "Share" (not "Share with colleague") to save toolbar space
- Text-based preview cards since transformed data is bullets, not full Slide objects

**Issues Resolved:**
- Verbosity fallback chain (verbosityCache[activeLevel] -> speakerNotes -> skip) for correct input text
- Bold marker stripping for clean export text in both PPTX and PDF
- originalPastedImage priority for thumbnail source in exports
- Async vs sync export handling (PDF async due to Image onload, PPTX sync)

**Issues Deferred:**
- Cover slide with delivery instructions for colleague (SHARE-01)
- Teacher name attribution on exported deck (SHARE-02)
- Per-slide regeneration in preview (SHARE-03)
- Editable script-version slides in-app before export (SHARE-04)

**Technical Debt Incurred:**
- None identified

---

_For current project status, see .planning/ROADMAP.md_
